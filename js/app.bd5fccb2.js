(function(){"use strict";var e={1816:function(e,n,i){var t=i(9242),o=i(3396);function a(e,n,i,t,a,s){const r=(0,o.up)("Cat");return(0,o.wg)(),(0,o.j4)(r)}var s=i(7139);const r=e=>((0,o.dD)("data-v-108512a4"),e=e(),(0,o.Cn)(),e),l=r((()=>(0,o._)("br",null,null,-1))),f=r((()=>(0,o._)("br",null,null,-1))),d={class:"canvWrapper"},c={class:"canvas",ref:"myCanvas"};function m(e,n,i,t,a,r){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",{class:"loading",id:"loading_text",style:(0,s.j5)({color:a.computedTextColor})},(0,s.zw)(a.loading_text),5),(0,o._)("div",{class:"createdBy",style:(0,s.j5)({color:a.computedTextColor})},[(0,o.Uk)("PRESS SPACE TO CHANGE COLOR"),l,(0,o.Uk)("CREATED BY XUAN TANG"),f,(0,o.Uk)("CONTACT: TXSTC55@GMAIL.COM")],4),(0,o._)("div",d,[(0,o._)("canvas",c,null,512)])],64)}i(7658);var u=i(1114),v=i(4543),x=i(6573),p=JSON.parse('[["#000000","#262A56","#B8621B","#E3CCAE"],["#245953","#408E91","#E49393","#D8D8D8"],["#000000","#F6F1F1","#146C94","#19A7CE"],["#000000","#146C94","#19A7CE","#F6F1F1"],["#00235B","#E21818","#FFDD83","#98DFD6"],["#4E6E81","#2E3840","#FF0303","#F9DBBB"],["#2C3333","#2E4F4F","#0E8388","#CBE4DE"],["#2B3467","#BAD7E9","#FCFFE7","#EB455F"],["#20262E","#913175","#CD5888","#E9E8E8"],["#D61355","#F94A29","#FCE22A","#30E3DF"],["#5D3891","#F99417","#E8E2E2","#F5F5F5"],["#EB455F","#FCFFE7","#BAD7E9","#2B3467"],["#F6F1F1","#19A7CE","#146C94","#000000"]]'),h=[{planeSpeed:"time / (1.0 + offsets[i]) + offsets[i]",angleSpeed:"time * (3.0 + offsets[i]) + offsets[i]",angleModifier:".3",lines:70},{planeSpeed:"time / (1.0 + offsets[i]) + offsets[i]",angleSpeed:"time / (2.0 + offsets[i]) + offsets[i]",angleModifier:"2.0",lines:25},{planeSpeed:"time / (2.0 + offsets[i]) + offsets[i]",angleSpeed:"time * (8.0 + offsets[i]) + offsets[i]",angleModifier:"0.5",lines:60},{planeSpeed:"time / (2.0 + offsets[i]) + offsets[i]",angleSpeed:"time / (0.1 + offsets[i]) + offsets[i]",angleModifier:"2.0",lines:25},{planeSpeed:"time / (0.1 + offsets[i]) + offsets[i]",angleSpeed:"time * (0.1 + offsets[i]) + offsets[i]",angleModifier:"0.8",lines:45},{planeSpeed:"(time / (0.1 + offsets[i]) + offsets[i]) / 3.0",angleSpeed:"time * (1.0 + offsets[i]) + offsets[i]",angleModifier:"1.5",lines:30}],g=h[Math.floor(Math.random()*h.length)],b=p[Math.floor(Math.random()*p.length)],w=Math.random()>.5?0:1,M=b[0],C=b[1+w],y=b[2-w],k=b[3];let E,_,A,F,T,S,D;var I=null,O=new u.jyz({uniforms:{color1:{value:new u.Ilk(C)},color2:{value:new u.Ilk(y)},planes:{value:[]},offsets:{value:[]},minOffset:{value:-1},maxOffset:{value:1},time:{value:0},center:{value:new u.Pa4(0,0,0)}},vertexShader:"\n    varying vec2 vUv;\n    #ifdef USE_SKINNING\n      uniform mat4 bindMatrix;\n      uniform mat4 bindMatrixInverse;\n      uniform highp sampler2D boneTexture;\n      uniform int boneTextureSize;\n\n      out vec4 mvPosition;\n      out vec3 positionCopy;\n\n      mat4 getBoneMatrix( const in float i ) {\n        float j = i * 4.0;\n        float x = mod( j, float( boneTextureSize ) );\n        float y = floor( j / float( boneTextureSize ) );\n        float dx = 1.0 / float( boneTextureSize );\n        float dy = 1.0 / float( boneTextureSize );\n        y = dy * ( y + 0.5 );\n        vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n        vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n        vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n        vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n        mat4 bone = mat4( v1, v2, v3, v4 );\n        return bone;\n      }\n    #endif\n    void main() {\n\n      vUv = uv;\n      positionCopy = position;\n      #ifdef USE_SKINNING\n        mat4 boneMatX = getBoneMatrix( skinIndex.x );\n        mat4 boneMatY = getBoneMatrix( skinIndex.y );\n        mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n        mat4 boneMatW = getBoneMatrix( skinIndex.w );\n        mat4 skinMatrix = mat4( 0.0 );\n        skinMatrix += skinWeight.x * boneMatX;\n        skinMatrix += skinWeight.y * boneMatY;\n        skinMatrix += skinWeight.z * boneMatZ;\n        skinMatrix += skinWeight.w * boneMatW;\n        skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n        vec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n        vec4 skinned = vec4( 0.0 );\n        skinned += boneMatX * skinVertex * skinWeight.x;\n        skinned += boneMatY * skinVertex * skinWeight.y;\n        skinned += boneMatZ * skinVertex * skinWeight.z;\n        skinned += boneMatW * skinVertex * skinWeight.w;\n        skinned  = bindMatrixInverse * skinned;\n        mvPosition = modelViewMatrix * skinned;\n        mvPosition.y -= 4.0;\n      #else\n        mvPosition = modelViewMatrix * vec4( position, 1.0 );\n        mvPosition.y -= 4.0;\n      #endif\n      gl_Position = projectionMatrix * mvPosition;\n    }",fragmentShader:`\n    uniform vec3 color1;\n    uniform vec3 color2;\n    varying vec2 vUv;\n    in vec4 mvPosition;\n    in vec3 positionCopy;\n    uniform vec4 planes[${g.lines}];\n    uniform float time;\n    uniform float offsets[${g.lines}];\n    uniform float minOffset;\n    uniform float maxOffset;\n    uniform vec3 center;\n\n    float hasIntersection = -1.0;\n    float distance = 100.0;\n    float offset = 0.0;\n    float angle;\n    float timedAngle = 0.0;\n    float end = 0.0;\n    int pickedIndex = 0;\n\n    float ATan2(vec2 dir)\n    {\n      float angle = asin(dir.x) > 0.0 ? acos(dir.y) : -acos(dir.y);\n      return angle;\n    }\n\n    float myMod(float a, float b)\n    {\n      return a - (b * floor(a/b));\n    }\n\n    void main() {\n      for (int i = 0; i < ${g.lines}; i++){\n        offset = sin(${g.planeSpeed});\n        offset = offset * (maxOffset - minOffset) / 4.0;\n        distance = abs(dot(planes[i].xyz, positionCopy) + planes[i].w + offset);\n        if (distance < 0.001){\n          // now check if angle is correct\n          vec3 direction = positionCopy - center;\n          angle = ATan2(normalize(vec2(direction.x, direction.y))) + 3.14150265;\n          timedAngle = myMod((${g.angleSpeed}) , 3.14159265 * 2.0);\n          angle = angle - timedAngle < 0.0? (angle - timedAngle + 2.0 * 3.14159265) : angle - timedAngle;\n          if (angle <= 3.14159265 * ${g.angleModifier}){\n            hasIntersection = 1.0;\n            pickedIndex = i;\n            break;\n          }\n        }\n      }\n      if (hasIntersection > 0.0){\n        if (positionCopy.x > 0.0){\n          gl_FragColor = vec4(color1 + (color2 - color1) * (sin(time * offsets[pickedIndex] + offsets[pickedIndex]) + 1.0) / 2.0, 1.0);\n        }else{\n          gl_FragColor = vec4(color2 + (color1 - color2) * (sin(time * offsets[pickedIndex] + offsets[pickedIndex]) + 1.0) / 2.0, 1.0);\n        }\n      } else {\n        // gl_FragColor = vec4(color2, 1.0);\n        discard;\n      }\n    }\n  `,skinning:!0,side:u.ehD,transparent:!0}),P={name:"Cat",data(){return{loadingDone:!1,loading_text:"0% LOADED, IT MAY TAKE A WHILE",planes:[],bbox:null,action_numbers:[3,9,11,15,21,25,26,27,30,33,38,40,41,44,47,48,50,52,55,58,60,61,62,65,67,70,71,74,78,80,83,84,87,97,100,101,105,113,114,115,120,122],animation_actions:[],animation_weights:[],current_action_index:0,oldTime:0,canChooseNew:!0,computedTextColor:k}},computed:{},methods:{setWeight(e,n){e.enabled=!0,e.setEffectiveTimeScale(1),e.setEffectiveWeight(n)},activateAction(e){this.setWeight(this.animation_actions[e],this.animation_weights[e]),this.animation_actions[e].play()},prepareCrossFade(e,n,i,t){e&&n?this.synchronizeCrossFade(e,n,i,t):this.executeCrossFade(e,n,i,t)},executeCrossFade(e,n,i,t){n?(this.setWeight(n,1),n.time=0,e?e.crossFadeTo(n,i,!0):n.fadeIn(i)):e.fadeOut(i),console.log("Action index from",this.current_action_index,"to",t),this.current_action_index=t,this.canChooseNew=!0},synchronizeCrossFade(e,n,i,t){S.addEventListener("loop",a);let o=this;function a(s){s.action._clip.name==e._clip.name&&(S.removeEventListener("loop",a),o.executeCrossFade(e,n,i,t))}},equation_plane(e,n,i){var t=e.x,o=n.x,a=i.x,s=e.y,r=n.y,l=i.y,f=e.z,d=n.z,c=i.z,m=o-t,v=r-s,x=d-f,p=a-t,h=l-s,g=c-f,b=v*g-h*x,w=p*x-m*g,M=m*h-v*p,C=-b*t-w*s-M*f;return new u.Ltg(b,w,M,C)},async init(){E=new u.xsS,_=new u.cPb(25,window.innerWidth/window.innerHeight,1,1e3),_.position.set(0,0,50),_.lookAt(E.position),A=new u.CP7({canvas:this.$refs.myCanvas,antialias:!0,powerPreference:"high-performance"}),A.setPixelRatio(window.devicePixelRatio),A.setSize(window.innerWidth,window.innerHeight),A.setClearColor(M,1),F=new v.z(_,A.domElement),F.enableDamping=!0,F.minDistance=5,F.maxDistance=500,window.addEventListener("resize",this.onWindowResize),window.addEventListener("keyup",this.onKeyUp);let e=this;T=new x.y,T.load("Cat_v01.fbx",(n=>{D=n,D.layers.toggle(1),e.bbox=(new u.ZzF).setFromObject(D);for(var i=0;i<g.lines;i++){var t=new u.Pa4(0,0,0),o=new u.Pa4(1,0,0),a=new u.Pa4(0,0,1),s=Math.random()*Math.PI,r=Math.random()*Math.PI;o.applyAxisAngle(new u.Pa4(1,0,0),s),a.applyAxisAngle(new u.Pa4(1,0,0),s),o.applyAxisAngle(new u.Pa4(0,0,1),r),a.applyAxisAngle(new u.Pa4(0,0,1),r);var l=(Math.random()*(e.bbox.max.x-e.bbox.min.x)+e.bbox.min.x)/2,f=(Math.random()*(e.bbox.max.z-e.bbox.min.z)+e.bbox.min.z)/2,d=(Math.random()*(e.bbox.max.y-e.bbox.min.y)+e.bbox.min.y)/2,c=new u.Pa4(l,d,f);t.add(c),o.add(c),a.add(c);var m=e.equation_plane(t,o,a);e.planes.push(m)}O.uniforms.planes.value=e.planes;var v=new u.Pa4;e.bbox.getCenter(v),O.uniforms.center.value=v,O.uniforms.minOffset.value=e.bbox.min.z,O.uniforms.maxOffset.value=e.bbox.max.z;var x=[];for(i=0;i<g.lines;i++)x.push(2*Math.random()*3.1415926);O.uniforms.offsets.value=x,D.scale.set(20,20,20),D.children[0].material=O,S=new u.Xcj(D);for(i=0;i<e.action_numbers.length;i++){const n=S.clipAction(D.animations[e.action_numbers[i]]);n||console.log("NO ACTION",i,e.action_numbers[i]),e.animation_actions.push(n),0==i?e.animation_weights.push(1):e.animation_weights.push(0),e.activateAction(i)}E.add(D),e.loadingDone=!0,e.loading_text="",I=new u.SUY}),(n=>{e.loading_text=Math.max(0,Math.floor(n.loaded/n.total*100)-1)+"% LOADED, IT MAY TAKE A WHILE"}),(e=>{console.log(e)}))},animate(){if(requestAnimationFrame(this.animate),F.update(),I){const i=I.getDelta();if(S){S.update(i);var e=I.getElapsedTime();if(e-this.oldTime>5&&this.canChooseNew&&Math.random()>.9){this.oldTime=e;var n=Math.floor(Math.random()*this.animation_actions.length);n!=this.current_action_index&&(this.canChooseNew=!1,this.prepareCrossFade(this.animation_actions[this.current_action_index],this.animation_actions[n],.35,n))}O.uniforms.time.value=e}}this.render()},render(){A.render(E,_)},onWindowResize(){_.aspect=window.innerWidth/window.innerHeight,_.updateProjectionMatrix(),A.setSize(window.innerWidth,window.innerHeight)},changeColor(){b=p[Math.floor(Math.random()*p.length)],w=Math.random()>.5?0:1,M=b[0],C=b[1+w],y=b[2-w],this.computedTextColor=b[3],A.setClearColor(M,1),O.uniforms.color1.value=new u.Ilk(C),O.uniforms.color2.value=new u.Ilk(y)},onKeyUp(e){32==e.keyCode&&this.changeColor()}},async mounted(){await this.init(),await this.animate()}},z=i(89);const W=(0,z.Z)(P,[["render",m],["__scopeId","data-v-108512a4"]]);var B=W,j={name:"App",components:{Cat:B}};const N=(0,z.Z)(j,[["render",a]]);var U=N;(0,t.ri)(U).mount("#app")}},n={};function i(t){var o=n[t];if(void 0!==o)return o.exports;var a=n[t]={exports:{}};return e[t](a,a.exports,i),a.exports}i.m=e,function(){var e=[];i.O=function(n,t,o,a){if(!t){var s=1/0;for(d=0;d<e.length;d++){t=e[d][0],o=e[d][1],a=e[d][2];for(var r=!0,l=0;l<t.length;l++)(!1&a||s>=a)&&Object.keys(i.O).every((function(e){return i.O[e](t[l])}))?t.splice(l--,1):(r=!1,a<s&&(s=a));if(r){e.splice(d--,1);var f=o();void 0!==f&&(n=f)}}return n}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[t,o,a]}}(),function(){i.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(n,{a:n}),n}}(),function(){i.d=function(e,n){for(var t in n)i.o(n,t)&&!i.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){var e={143:0};i.O.j=function(n){return 0===e[n]};var n=function(n,t){var o,a,s=t[0],r=t[1],l=t[2],f=0;if(s.some((function(n){return 0!==e[n]}))){for(o in r)i.o(r,o)&&(i.m[o]=r[o]);if(l)var d=l(i)}for(n&&n(t);f<s.length;f++)a=s[f],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(d)},t=self["webpackChunkcat"]=self["webpackChunkcat"]||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))}();var t=i.O(void 0,[998],(function(){return i(1816)}));t=i.O(t)})();
//# sourceMappingURL=app.bd5fccb2.js.map